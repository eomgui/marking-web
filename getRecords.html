<style>
	.nobgimg_menu {
		background-image: none !important;
		font-size: 12px !important;
		padding:0px !important;
	}
	.prevRecords_menu {
		padding: 10px 15px !important;
		font-size: 12px !important;
	}
	.smaller_submenuRecord{
		width:135px !important;
	}
	.smaller_submenuView{
		width:112px !important;
	}
</style>
<div id ='record_header'></div>
<ul class="pureCssMenu pureCssMenum" id='right_header'>
	<li class="pureCssMenui0">
		<a id='menu_visible_class' class="prevRecords_menu" href="#"><img src="css/images/edit_icon.png" width="12px" height='12px'/>Edit</a>
	</li>
	<li id='class_main_menu' class="pureCssMenui0">
		<a class="prevRecords_menu" href="#"><img src="css/images/record_icon.png" width="12px" height='12px'/><span>Record New</span><![if gt IE 6]></a><![endif]><!--[if lte IE 6]><table><tr><td><![endif]-->
		<ul class="pureCssMenum smaller_submenuRecord">
			<li class="pureCssMenui">
				<a class="pureCssMenui prevRecords_menu" href="#"><span class='nobgimg_menu'>Observation</span><![if gt IE 6]></a><![endif]><!--[if lte IE 6]><table><tr><td><![endif]-->
			</li>
			<!--[if lte IE 6]></td></tr></table></a><![endif]-->
			<li class="pureCssMenui">
				<a class="pureCssMenui prevRecords_menu" href="#"><span class='nobgimg_menu'>Conversation</span><![if gt IE 6]></a><![endif]><!--[if lte IE 6]><table><tr><td><![endif]-->
			</li>
			<li class="pureCssMenui">
				<a class="pureCssMenui prevRecords_menu" href="#"><span class='nobgimg_menu'>Product</span><![if gt IE 6]></a><![endif]><!--[if lte IE 6]><table><tr><td><![endif]-->
			</li>
		</ul>
		<!--[if lte IE 6]></td></tr></table></a><![endif]-->
	</li>
	<li id='class_main_menu' class="pureCssMenui0">
		<a class="prevRecords_menu" href="#"><img src="css/images/view_icon.png" width="12px" height='12px'/><span>View All</span><![if gt IE 6]></a><![endif]><!--[if lte IE 6]><table><tr><td><![endif]-->
		<ul class="pureCssMenum smaller_submenuView">
			<li class="pureCssMenui">
				<a class="pureCssMenui prevRecords_menu" href="#"><span class='nobgimg_menu'>Observation</span><![if gt IE 6]></a><![endif]><!--[if lte IE 6]><table><tr><td><![endif]-->
			</li>
			<li class="pureCssMenui">
				<a class="pureCssMenui prevRecords_menu" href="#"><span class='nobgimg_menu'>Conversation</span><![if gt IE 6]></a><![endif]><!--[if lte IE 6]><table><tr><td><![endif]-->
			</li>
			<li class="pureCssMenui">
				<a class="pureCssMenui prevRecords_menu" href="#"><span class='nobgimg_menu'>Product</span><![if gt IE 6]></a><![endif]><!--[if lte IE 6]><table><tr><td><![endif]-->
			</li>
		</ul>
		<!--[if lte IE 6]></td></tr></table></a><![endif]-->
	</li>
	<li class="pureCssMenui0">
		<a id='menu_visible_class' class="prevRecords_menu" href="#"><img src="css/images/graphical_view_icon.png" width="12px" height='12px'/>Graphical View</a>
	</li>
</ul>
<script type="text/javascript" charset="utf-8">
	$(document).ready(function() {
		$("#student_list option:selected").each(function() {
			$("#record_header").html($(this).html() + "----------" + $("#menu_visible_class").html());
		});
	});
	
	var communications = {}; //final result of getCommunications
	
	function getCommunications(type, skills) {
		var expectations = {};
		params.fcn = 'selectExpectationsByCourse'; //Get all expectations from course
		params.params = {
			course : $("#menu_visible_class").attr("class_id") //use selected class id to get expectations
		};
		/* ^Those three lines weren't there before. After the last pull request, I realized that under
		 * certain circumstances the function would use the wrong set of expectations. I hypothesized that
		 * selectExpectationsByCourse was using the previous student ID as its "section ID".
		 * Looks like I was right. --Richard Yin; May 3, 2012*/
		
		jQuery.getJSON(IP + "/mark/model/expectations-model.php?callback=?", params, function(expecData) {
			if(!expecData[0]) { //standard if/else statement: if the first value is false, there's an error
				$("#error_text").html(expecData[1][0]);
				$("#error_msg").show(); //standard error display
				$("#msg").hide();
			} else {
				for(i in expecData[1]) {
					expectations[i] = expecData[1][i][0]; //Store expectations in array
				}
				var stid = $("option.std_opt:selected").attr('id'); //selected student id in the menu
				params.fcn = 'selectObservationsAndOrConvos'; //getting communications off server
				params.params = {
					id : stid, //from selected menu item
					recType : type, //type given to function
					third : [skills, expectations] //Use expectations array to get communications
				}
				
				jQuery.getJSON(IP + "/mark/model/communications-model.php?callback=?", params, function(data) {
					if(!data[0]) { //standard error checking, etc
						$("#error_text").html(data[1][0]);
						$("#error_msg").show();
						$("#msg").hide();
					} else {
						for(i in data[1]) { //store comment with index equal to comment id
							communications[data[1][i][0]] = data[1][i][2];
						}
						for(c in communications) //testing
						{
							console.log(c);
							console.log(communications[c]);
						} //end testing for loop
					} //end if/else statement for selectObservationsAndOrConvos
				}); //end getJSON function for selectObservationsAndOrConvos
			} //end if/else statement for selectExpectationsByCourse
		}); //end getJSON function for selectExpectationsByCourse
	} //end getCommunications
</script>